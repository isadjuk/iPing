#!/bin/bash

# VARIABLES
IP="192.168.1.";
IP_START=2;
IP_END=254;

# MAIN PROGRAM
echo -e "\n========================================================================"
echo -e "MAC ADDRESS \t\t IP ADDRESS \t NETBIOS NAME";
x=$IP_START;
while [ $x -le $IP_END ]; 
	do
	IP_CURRENT="${IP}${x}";
	ping -c 1 -W 1 $IP_CURRENT > /dev/null
	
	# IF ping received OK
	if [ "$?" = "0" ]; then
		IP_NAME="`nmblookup -A $IP_CURRENT | grep '<00> - ' | cut -f2 | awk -F' ' '{print $1}' | head -n 1`";
		IP_MAC="`arp -a $IP_CURRENT | awk -F' ' '{print $4}'`";
		
		# checking corrected name
		if [ "$IP_NAME" = "" ]; then
			IP_NAME="\t";
			fi

		# checking corrected mac address	
		if [ "$IP_MAC" = "entries" ]; then
			IP_MAC="--:--:--:--:--:--";
			fi
			
		echo -e "$IP_MAC \t $IP_CURRENT \t $IP_NAME";
		fi
		
	x=$[x + 1]
	done
echo -e "========================================================================\n"

